"""
Tests for CategoricalIndex.__repr__ and related methods.
"""
import pytest

from pandas._config import using_string_dtype
import pandas._config.config as cf

from pandas import CategoricalIndex
import pandas._testing as tm


class TestCategoricalIndexRepr:
    def test_format_different_scalar_lengths(self):
        # GH#35439
        idx = CategoricalIndex(["aaaaaaaaa", "b"])
        expected = ["aaaaaaaaa", "b"]
        msg = r"CategoricalIndex\.format is deprecated"
        with tm.assert_produces_warning(FutureWarning, match=msg):
            assert idx.format() == expected

    @pytest.mark.xfail(using_string_dtype(), reason="repr different")
    def test_string_categorical_index_repr(self):
        # short
        idx = CategoricalIndex(["a", "bb", "ccc"])
        expected = """CategoricalIndex(['a', 'bb', 'ccc'], categories=['a', 'bb', 'ccc'], ordered=False, dtype='category')"""  # noqa: E501
        assert repr(idx) == expected

        # multiple lines
        idx = CategoricalIndex(["a", "bb", "ccc"] * 10)
        expected = """CategoricalIndex(['a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a',
                  'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb',
                  'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc'],
                 categories=['a', 'bb', 'ccc'], ordered=False, dtype='category')"""  # noqa: E501

        assert repr(idx) == expected

        # truncated
        idx = CategoricalIndex(["a", "bb", "ccc"] * 100)
        expected = """CategoricalIndex(['a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a',
                  ...
                  'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc', 'a', 'bb', 'ccc'],
                 categories=['a', 'bb', 'ccc'], ordered=False, dtype='category', length=300)"""  # noqa: E501

        assert repr(idx) == expected

        # larger categories
        idx = CategoricalIndex(list("abcdefghijklmmo"))
        expected = """CategoricalIndex(['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l',
                  'm', 'm', 'o'],
                 categories=['a', 'b', 'c', 'd', ..., 'k', 'l', 'm', 'o'], ordered=False, dtype='category')"""  # noqa: E501

        assert repr(idx) == expected

        # short
        idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"])
        expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†'], categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category')"""  # noqa: E501
        assert repr(idx) == expected

        # multiple lines
        idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"] * 10)
        expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚',
                  'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„',
                  'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†'],
                 categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category')"""  # noqa: E501

        assert repr(idx) == expected

        # truncated
        idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"] * 100)
        expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚',
                  ...
                  'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†'],
                 categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category', length=300)"""  # noqa: E501

        assert repr(idx) == expected

        # larger categories
        idx = CategoricalIndex(list("ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ã"))
        expected = """CategoricalIndex(['ã‚', 'ã„', 'ã†', 'ãˆ', 'ãŠ', 'ã‹', 'ã', 'ã', 'ã‘', 'ã“', 'ã•', 'ã—',
                  'ã™', 'ã›', 'ã'],
                 categories=['ã‚', 'ã„', 'ã†', 'ãˆ', ..., 'ã—', 'ã™', 'ã›', 'ã'], ordered=False, dtype='category')"""  # noqa: E501

        assert repr(idx) == expected

        # Enable Unicode option -----------------------------------------
        with cf.option_context("display.unicode.east_asian_width", True):
            # short
            idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"])
            expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†'], categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category')"""  # noqa: E501
            assert repr(idx) == expected

            # multiple lines
            idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"] * 10)
            expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„',
                  'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†',
                  'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„',
                  'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†'],
                 categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category')"""  # noqa: E501

            assert repr(idx) == expected

            # truncated
            idx = CategoricalIndex(["ã‚", "ã„ã„", "ã†ã†ã†"] * 100)
            expected = """CategoricalIndex(['ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„',
                  'ã†ã†ã†', 'ã‚',
                  ...
                  'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†', 'ã‚', 'ã„ã„', 'ã†ã†ã†',
                  'ã‚', 'ã„ã„', 'ã†ã†ã†'],
                 categories=['ã‚', 'ã„ã„', 'ã†ã†ã†'], ordered=False, dtype='category', length=300)"""  # noqa: E501

            assert repr(idx) == expected

            # larger categories
            idx = CategoricalIndex(list("ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ã"))
            expected = """CategoricalIndex(['ã‚', 'ã„', 'ã†', 'ãˆ', 'ãŠ', 'ã‹', 'ã', 'ã', 'ã‘', 'ã“',
                  'ã•', 'ã—', 'ã™', 'ã›', 'ã'],
                 categories=['ã‚', 'ã„', 'ã†', 'ãˆ', ..., 'ã—', 'ã™', 'ã›', 'ã'], ordered=False, dtype='category')"""  # noqa: E501

            assert repr(idx) == expected

